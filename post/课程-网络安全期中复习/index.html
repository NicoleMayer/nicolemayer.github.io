<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>è¯¾ç¨‹ ç½‘ç»œå®‰å…¨ æœŸä¸­å¤ä¹  | Hanmei@æ¢…</title>
    <meta property="og:title" content="è¯¾ç¨‹ ç½‘ç»œå®‰å…¨ æœŸä¸­å¤ä¹  - Hanmei@æ¢…">
    <meta property="og:type" content="article">
    
    <meta property="article:published_time" content='2019-10-28T18:57:31&#43;08:00'>
    
    
    <meta property="article:modified_time" content='2019-10-28T18:57:31&#43;08:00'>
    
    <meta name="Keywords" content="">
    <meta name="description" content="è¯¾ç¨‹ ç½‘ç»œå®‰å…¨ æœŸä¸­å¤ä¹ ">
    
    <meta name="author" content="">
    <meta property="og:url" content="https://hanmei.netlify.com/post/%E8%AF%BE%E7%A8%8B-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E6%9C%9F%E4%B8%AD%E5%A4%8D%E4%B9%A0/">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    


    
    
</head>

<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                <a id="logo" href="https://hanmei.netlify.com/">
                    Hanmei@æ¢…
                </a>
                
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    
                    <a  href="https://hanmei.netlify.com/"
                        title="é¦–é¡µ">é¦–é¡µ</a>
                    
                    <a  href="https://hanmei.netlify.com/archives/"
                        title="å­˜æ¡£">å­˜æ¡£</a>
                    
                    <a  href="https://hanmei.netlify.com/ideas/"
                        title="ç¢ç¢å¿µ">ç¢ç¢å¿µ</a>
                    
                    <a  href="https://hanmei.netlify.com/about/"
                        title="å…³äº">å…³äº</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>
    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">æ–‡ç« ç›®å½•</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
<ul>
<li><a href="#topics">Topics</a></li>
<li><a href="#details">Details</a>
<ul>
<li><a href="#1-cryptography">1. cryptography</a></li>
<li><a href="#2-symmetric-encrption">2. symmetric encrption</a>
<ul>
<li><a href="#2-1-ç‰¹ç‚¹">2.1 ç‰¹ç‚¹</a></li>
<li><a href="#2-2-des">2.2 DES</a>
<ul>
<li><a href="#2-2-1-block-cipher">2.2.1 Block cipher</a></li>
<li><a href="#2-2-2-basic-structure-of-des">2.2.2 Basic Structure of DES</a></li>
</ul></li>
<li><a href="#2-3-modes-of-operation">2.3 Modes of Operation</a></li>
<li><a href="#2-3-aes">2.3 AES</a></li>
</ul></li>
<li><a href="#3-hash">3. hash</a>
<ul>
<li><a href="#3-1-cryptographic-hash-functions">3.1 Cryptographic Hash Functions</a></li>
<li><a href="#3-2-merkle-damgard-construction">3.2 Merkle-Damgard construction</a></li>
<li><a href="#3-3-birthday-paradox">3.3 Birthday Paradox</a></li>
<li><a href="#3-4-chf-from-a-block-cipher">3.4 CHF from a Block Cipher</a></li>
<li><a href="#3-5-hash-func-examples">3.5 Hash Func Examples</a></li>
<li><a href="#3-6-message-authentication">3.6 Message Authentication</a></li>
<li><a href="#3-7-hmac">3.7 HMAC</a></li>
</ul></li>
<li><a href="#4-asymmetric-encryption-å››-äº”">4. asymmetric encryption [å››ã€äº”]</a>
<ul>
<li><a href="#4-1-number-theory">4.1 Number Theory</a></li>
<li><a href="#4-2-asymmetric-cryptography">4.2 Asymmetric Cryptography</a>
<ul>
<li><a href="#4-2-1-diffie-hellman-key-exchange">4.2.1 Diffieâ€“Hellman key exchange</a></li>
<li><a href="#4-2-2-rsa">4.2.2 RSA</a></li>
<li><a href="#4-2-3-el-gamal">4.2.3 El Gamal</a></li>
<li><a href="#4-2-4-the-digital-signature-standard-dss">4.2.4 The Digital Signature Standard (DSS)</a></li>
<li><a href="#4-2-5-zero-knowledge-proof">4.2.5 Zero-knowledge proof</a></li>
<li><a href="#4-2-6-fiat-shamir-identification-scheme">4.2.6 Fiat-Shamir Identification Scheme</a></li>
</ul></li>
</ul></li>
<li><a href="#reference">Reference</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if(leftPos<220){
                postToc.css({"width":leftPos-10,"margin-left":(0-leftPos)})
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">è¯¾ç¨‹ ç½‘ç»œå®‰å…¨ æœŸä¸­å¤ä¹ </h1>
        </header>
        <date class="post-meta meta-date">
            2019å¹´10æœˆ28æ—¥
        </date>
        
        <div class="post-meta">
            <span>|</span>
            
            <span class="meta-category"><a href='https://hanmei.netlify.com/categories/CS%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0'>CSè¯¾ç¨‹å­¦ä¹ </a></span>
            
        </div>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    é˜…è¯»</span></span>
        </div>
        
        
        <div class="clear" style="display: none">
            <div class="toc-article">
                <div class="toc-title">æ–‡ç« ç›®å½•</div>
            </div>
        </div>
        
        <div class="post-content">
            <p>ç‰¹é•¿ï¼ŒçŸ¥è¯†ç‚¹ç‰¹å¤šï¼Œé€‚åˆå“ªé‡Œä¸ä¼šæŸ¥å“ªé‡Œã€‚</p>

<h1 id="topics">Topics</h1>

<p>What topics have I learned so far? æ‘˜è‡ª<a href="https://www.ics.uci.edu/~alfchen/teaching/cs134-2019-Fall/lectures.html">è¯¾ç¨‹ä¸»é¡µ</a></p>

<p>ä¸€ã€Cryptography: History and Simple Encryption Method</p>

<p>Topics: Historical Ciphers, Crypto Terminology</p>

<p>äºŒã€Encryption</p>

<p>Topics: Symmetric/Convential vs. Public Key Cryptograpy, Block Ciphers, DES, Other Symmetric Ciphers, AES/Rijndael, OTP (Refresher)</p>

<p>ä¸‰ã€Cryptographic Hash Functions</p>

<p>Topics: Cryptographic Properties, Simple Hash Functions, MD5, SHA, HMAC</p>

<p>å››ã€Some &ldquo;fun&rdquo; math</p>

<p>Topics: Groups, Rings, Fields, Euclidean Algorithm, Chinese Remainder Theorem</p>

<p>äº”ã€Public Key Cryptography</p>

<p>Topics: Diffie Hellman Key Exchange, RSA Encryption, Square-and-Multiply, El Gamal Encryption, Digital Signatures (RSA and El Gamal), Digital Signature Standard (DSS), Identification (Fiat-Shamir), Zero-Knowledge Cave</p>

<p>å…­ã€Authentication and Key Distribution</p>

<p>Topics: Definitions, Types of Authentication, Biometrics, Protocols, Key Distribution</p>

<p>å†…å®¹å·²è½¬ç§»åˆ°å¦ä¸€ç¯‡<a href="../è¯¾ç¨‹-ç½‘ç»œå®‰å…¨-authentication">åšæ–‡</a></p>

<h1 id="details">Details</h1>

<h2 id="1-cryptography">1. cryptography</h2>

<p><strong>some concepts</strong>ï¼š</p>

<ul>
<li>security service</li>
<li>security mechanism (e.g. cryptography, system controls os æˆ–è€… db, hardware controls smartcards, policies å®šæœŸä¿®æ”¹å¯†ç , physical controls ç‰©ç†éš”ç»)</li>
<li>security attack (e.g. <strong>Interruption</strong>, <strong>Interception</strong>, <strong>Modification</strong>, <strong>Fabrication</strong> åˆ†åˆ«å¯¹åº” <strong>availability</strong> å¯è·å¾—æ€§, <strong>Confidentiality</strong> ä¿å¯†æ€§, <strong>Integrity</strong> å®Œæ•´æ€§, <strong>Authentication</strong> è®¤è¯æ€§)</li>
<li>æ¥è‡ªå¤–éƒ¨çš„æ”»å‡»ï¼špassive threatsï¼ˆæ•°æ®ä¿å¯†ï¼‰ / active threatsï¼ˆæ¶ˆæ¯è®¤è¯ï¼‰</li>
<li>æ¥è‡ªå†…éƒ¨çš„æ”»å‡»ï¼šå‘é€æ–¹å¦è®¤ / æ¥æ”¶æ–¹å¦è®¤ï¼ˆæ•°å­—ç­¾åï¼‰</li>
<li>open / closed design model</li>
</ul>

<blockquote>
<p>Closed design has many benefits. An average attacker that does not have access to the algorithm must start from understanding the algorithm before he/she can attack the system. Understanding the algorithm usually takes a very long time and the attacker must spend a lot of resource to accomplish it.</p>

<p>However, there are cases where the attacker has a lot of time and resources. This might be an adversary that is backed by a large company or even a nation state. Moreover, algorithms might leak for some reason. This is possible, for example, through social engineering or even angry employees that seek revenge. Closed design systems rely on the secrecy of the algorithm, and once leaked, the system is already vulnerable.</p>

<p>In open design, we assume that the adversary already has access to the algorithm. This in itself is already better than the closed design, because we do not have to worry about how resourceful our attackers are. Since open design algorithm assumes adversaries with arbitrary strength, they must rely on math that even the most powerful adversary cannot solve. That is why a lot of the algorithms we see in the class is based on NP-complete problems, which is assumed that there are no algorithm that solves it efficiently.</p>
</blockquote>

<p><strong>simple encryption method</strong>: shift, affine, substitution, vigenereï¼ˆç”Ÿæˆä¸€åˆ—æ•°ä¸messageç›¸åŠ ï¼‰, vernam (<strong>one-time-pad</strong> ç”Ÿæˆä¸€åˆ—æ•°ä¸messageå¼‚æˆ–)</p>

<p><strong>A cryptosystem has</strong> (at least) :</p>

<ul>
<li>Plaintext</li>
<li>Secret Key</li>
<li>Ciphertext</li>
<li>Encryption Algorithm</li>
<li>Decryption Algorithm</li>
</ul>

<p><strong>Attacks on Classical Cryptography</strong></p>

<ul>
<li>Ciphertext-only attack</li>
<li>Known-plaintext attack</li>
<li>Chosen plaintext</li>
<li>Chosen ciphertext</li>
<li>Brute force / ç»Ÿè®¡åˆ†æ / æ•°å­¦åˆ†æ</li>
</ul>

<p><strong>å¯†é’¥é•¿åº¦ä¸æš´åŠ›ç ´è§£æ—¶é—´å¯¹ç…§è¡¨</strong></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123181745.jpg" alt="" /></p>

<p><strong>Attainable Security</strong></p>

<ul>
<li>Perfect, unconditional or â€œinformation theoreticâ€</li>
<li>Reducible or â€œprovableâ€</li>
<li>Ad hoc åªæ˜¯çœ‹èµ·æ¥å¯è¡Œ</li>
</ul>

<blockquote>
<p>A cryptosystem with computational security is, for the mean time, unbreakable. It relies on the hardness of a NP-complete problem (such as solving discrete logarithm) to ensure the security of the system. There are no known efficient algorithms that solve such NP-complete problems, but we do not know when it might appear in the future. That is why such system is &ldquo;for the mean time&rdquo; unbreakable.</p>

<p>A cryptosystem with information theoretic security is provenly unbreakable. Even if software or hardware mature in the future, such systems will still be unbreakable, unlike computational security.</p>

<p>Proving whether a system is computationally secure or information theoretically secure is way out of what we cover in this course, but I will give you a very simple intuition behind how we can prove it.</p>

<p>To prove whether a system is information theoretically secure, you have to prove that a plaintext will be transformed to any possible ciphertext that is the same length as the plaintext. To achieve that, the plaintext must be encrypted with a key with the same length or larger than the plaintext. Also, the key must be chosen truly random from a given distribution. There is only one cryptosystem that does this, and it is called one-time pad.</p>

<p>To prove whether a system is computationally secure is a little more complex, but to give you an intuition, you can do it by proving that the security of the cryptosystem relies on the hardness of the underlying mathematical problem. This is called &ldquo;reducing&rdquo; in cryptography.</p>

<p>If you are interested in learning more about this, you should take a cryptography course.</p>
</blockquote>

<p><strong>Computational security</strong> æ˜¯æŒ‡ç ´è§£çš„å¼€é”€ &gt; ä¿¡æ¯æœ¬èº«çš„ä»·å€¼ æˆ–æ˜¯ ç ´è§£èŠ±è´¹çš„æ—¶é—´ &gt; ä¿¡æ¯çš„æ—¶æ•ˆæ€§</p>

<p><strong>kerchkoffsåŸåˆ™</strong> æ˜¯æŒ‡åŠ å¯†ç®—æ³•åº”å»ºç«‹åœ¨ç®—æ³•çš„å…¬å¼€ä¸Šï¼Œå¹¶ä¸”å…¬å¼€ç®—æ³•ä¸å½±å“æ˜æ–‡å’Œå¯†é’¥çš„å®‰å…¨</p>

<p><strong>åŠ å¯†ç®—æ³•åˆ†ç±»</strong></p>

<ul>
<li>operation type (binary/integer arithemetic)</li>
<li># of keys (å¯¹ç§°/éå¯¹ç§°)</li>
<li>how plaintext is processed (block cipher/stream cipher)</li>
</ul>

<h2 id="2-symmetric-encrption">2. symmetric encrption</h2>

<h3 id="2-1-ç‰¹ç‚¹">2.1 ç‰¹ç‚¹</h3>

<ul>
<li>ç¼ºç‚¹: 1. key distribution (secure? efficient?) 2. management problem (remain secret both side) 3. short life time (ç›¸å¯¹è€Œè¨€)</li>
<li>ä¼˜ç‚¹: 1. high data throughput 2. short key size (ç›¸å¯¹) 3. simple</li>
<li>ä½¿ç”¨æ—¶éœ€æ³¨æ„: 1. meesage transmission (å®‰å…¨çš„ä¿¡é“) 2. secure storage 3. strong authentication 4. digital sigature (åº”ç”¨)</li>
<li>ä¸éå¯¹ç§°åŠ å¯†å¯¹æ¯”: éå¯¹ç§°åŠ å¯†ä¿å¯†æ€§è¾ƒå¥½ï¼Œèƒ½æŒç»­çš„æ—¶é—´é•¿ï¼Œæ•°å­—ç­¾åå¾ˆé«˜æ•ˆï¼›ä½†æ˜¯å®ƒçš„key sizeå¾ˆå¤§ï¼ˆç›¸å¯¹ä¼ ç»ŸåŠ å¯†ç®—æ³•ï¼ŒRSAæœ‰2048ä½ï¼Œ3-DESæœ‰112ä½ï¼ŒAESæœ‰216ä½ï¼‰å¯¼è‡´è¿è¡Œæ•ˆç‡æ¯”è¾ƒä½ï¼Œæ­¤å¤–å®ƒçš„è¿è¡Œå»ºç«‹åœ¨å½“å‰äººç±»ç®—åŠ›çš„åŸºç¡€ä¸Šï¼Œä¸ä¿è¯å°†æ¥æ˜¯å¦è¡Œå¾—é€šã€‚</li>
</ul>

<h3 id="2-2-des">2.2 DES</h3>

<p>å…¨ç§° data encryption standard</p>

<h4 id="2-2-1-block-cipher">2.2.1 Block cipher</h4>

<p><strong>Generic Example of Block Encryption</strong></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123181813.jpg" alt="" /></p>

<p><strong>Feistel Cipher Structure</strong></p>

<p>ä¸‹å›¾ä¸º1973å¹´Horst Feistelæå‡ºï¼ŒåŸºæœ¬ä¸Šæ‰€æœ‰ block encrption éƒ½æ»¡è¶³è¿™ä¸ªæ¡†æ¶:
<img src="http://q5f66uxyd.bkt.clouddn.com/20191123181840.jpg" alt="" />
å…¶ä¸­ç®—æ³•çš„å®‰å…¨æ€§ç”±å›¾ä¸Š4éƒ¨åˆ†å†³å®š</p>

<p><strong>block cipher å†å²</strong></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123181901.jpg" alt="" /></p>

<h4 id="2-2-2-basic-structure-of-des">2.2.2 Basic Structure of DES</h4>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123181931.jpg" alt="" /></p>

<p>For each round, åŠ å¯† and è§£å¯†:</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191122084347.png" alt="" /></p>

<p>Key schedule:</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191122085451.png" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182004.jpg" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182044.jpg" alt="" /></p>

<p>Function F:</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182107.jpg" alt="" /></p>

<p>DES Substitution Boxes Operation:</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182132.jpg" alt="" /></p>

<p>Sç›’çš„ä¾‹å­ï¼ˆæ‘˜è‡ªå¼•ç”¨2ï¼‰</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182212.jpg" alt="" /></p>

<p>Operation Tables of DES:</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182237.jpg" alt="" /></p>

<p>Breaking DES (Cryptanalysis)</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182252.jpg" alt="" /></p>

<p>Meet-in-the-middle ATTACK</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182336.jpg" alt="" /></p>

<p>DES Variants</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191122090022.jpg" alt="" /></p>

<h3 id="2-3-modes-of-operation">2.3 Modes of Operation</h3>

<p>å¯å‚è€ƒ<a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation">ç»´åŸºç™¾ç§‘</a></p>

<p><strong>2.3.1 &ldquo;Nativeâ€ ECB Mode</strong></p>

<p>Electronic Code-Book (ECB) Mode</p>

<div>
  $$
  C_i = E ( K, P_i ) 
  $$
</div>

<div>
  $$
  P_i = D ( K, C_i )
  $$
</div>

<p><strong>ç‰¹ç‚¹ï¼š</strong></p>

<ul>
<li>åŒæ ·çš„æ˜æ–‡ä¼šç”Ÿæˆç›¸åŒçš„åŠ å¯†å—ï¼Œciphertext å¯èƒ½å­˜åœ¨é‡å¤ (same patterns) -&gt; å®¹æ˜“æ”¶åˆ° replay æ”»å‡»</li>
<li>Ciphertext block rearrangement is possible -&gt; block ä¹‹é—´äº¤æ¢ä¸ä¼šå½±å“æœ€åçš„ç»“æœï¼Œæ‰€ä»¥éœ€è¦åœ¨ plaintext ä¸­åŠ å…¥ block numbering</li>
<li>åŠ å¯†å’Œè§£å¯†å¯ä»¥å¹¶è¡ŒåŒ– (random access)</li>
<li>Error in one ciphertext block -&gt; one-block loss</li>
</ul>

<p><strong>2.3.2 CBC Mode</strong></p>

<p>Cipher-Block Chaining (CBC) Mode</p>

<div>
  $$
  C_i = E ( K, P_i âŠ• C_{i-1} ), C_0=IV
  $$
</div>

<div>
  $$
  P_i = D ( K, C_i ) âŠ• C_{i-1}
  $$
</div>

<p><strong>ç‰¹ç‚¹ï¼š</strong></p>

<ul>
<li>åŒæ ·çš„æ˜æ–‡ä¼šç”Ÿæˆä¸åŒçš„åŠ å¯†å—</li>
<li>Block rearrangement is detectable -&gt; å› ä¸ºäº¤æ¢é¡ºåºä¼šå½±å“å‰ä¸€ä¸ªblockçš„cipher</li>
<li>åŠ å¯†æ— æ³•å¹¶è¡ŒåŒ–ï¼Œä½†è§£å¯†å¯ä»¥</li>
<li>Error in one <strong>ciphertext</strong> block -&gt; two-block loss</li>
</ul>

<p><strong>2.3.3 OFB Mode</strong></p>

<p>Output Feedback (OFB) Mode</p>

<div>
  $$
  C_i = E ( K, V_{i-1} ) âŠ• P_i
  $$
</div>

<div>
  $$
  V_0=IV, . . . ,V_i = E ( K, V_{i-1} )
  $$
</div>

<div>
  $$
  P_i = E ( K, V_{i-1} ) âŠ• C_i
  $$
</div>

<p><strong>ç‰¹ç‚¹ï¼š</strong></p>

<ul>
<li>åŒæ ·çš„æ˜æ–‡ä¼šç”Ÿæˆä¸åŒçš„åŠ å¯†å—</li>
<li>Block rearrangement is detectable</li>
<li>Key-stream is independent of plaintext</li>
<li>Error in one ciphertext block -&gt; one-block loss</li>
<li>One-block ciphertext loss -&gt; big mess</li>
<li>Can encrypt less than block size</li>
<li>Can be run in parallel if the keystream is pre-computed</li>
</ul>

<p><strong>2.3.4 CFB Mode</strong>
Cipher Feedback (CFB) Mode</p>

<div>
  $$
  C_i = P_i âŠ• E (K, C_{i-1}), C_0=IV
  $$
</div>

<div>
  $$
  P_i = E ( K, C_{i-1} ) âŠ• C_i
  $$
</div>

<p><strong>ç‰¹ç‚¹ï¼š</strong></p>

<ul>
<li>åŒæ ·çš„æ˜æ–‡ä¼šç”Ÿæˆä¸åŒçš„åŠ å¯†å—</li>
<li>Block rearrangement is detectable</li>
<li>Key-stream is <strong>dependent of</strong> plaintext</li>
<li>Bit error in one ciphertext block -&gt; one-bit + one-block loss in plaintext</li>
<li>Error in one ciphertext block -&gt; 1-extra-block loss</li>
<li>Can encrypt less than block size</li>
</ul>

<p><strong>2.3.5 CTR Mode</strong></p>

<p>Counter (CTR) Mode</p>

<div>
  $$
  C_i = E ( K, CTR ) âŠ• Pi, CTR ++
  $$
</div>

<div>
  $$
  P_i = E ( K, CTR ) âŠ• C_i
  $$
</div>

<p><strong>ç‰¹ç‚¹ï¼š</strong></p>

<ul>
<li>Duplicate plaintext blocks (patterns) NOT exposed, unless?</li>
<li>Block rearrangement is detectable</li>
<li>Key-stream is independent of plaintext</li>
<li>åŠ å¯†å’Œè§£å¯†å¯ä»¥å¹¶è¡ŒåŒ– (random access)</li>
<li>Bit error in one ciphertext block -&gt; one-bit error in plaintext</li>
<li>One-block ciphertext loss -&gt; big mess (I think this is assuming that the receiver does not know which ciphertext block was lost. In that case he does not know which index needs to be skipped for decryption and so all the blocks after the lost block will be decrypted to garbage since their index is shifted by the number of blocks lost)</li>
<li>Can encrypt less than block size</li>
</ul>

<p><strong>2.3.6 MAC Mode</strong></p>

<p>Message Authentication Code (MAC) Mode</p>

<div>
  $$
  C_i = E ( K, P_i âŠ• C_{i-1} ), C_0=IV
  $$
</div>

<p>What is sent or stored: $$P1, &hellip;, Pn$$, $$Cn = MAC$$</p>

<p>Receiver recomputes Cn with K and compares</p>

<p><strong>ç‰¹ç‚¹ï¼š</strong></p>

<ul>
<li>Encryption is the same as in CBC mode, but, ciphertext is NOT sent!</li>
<li>Any change in plaintext results in unpredictable changes in MAC</li>
</ul>

<blockquote>
<p>Q: DIfference between CBC mode and MAC mode</p>

<hr />

<p>A: First of all, <strong>MAC is not a mode of encryption</strong>. It stands for &ldquo;Message Authentication Code&rdquo; and it is used to <strong>provide integrity to the sent message</strong>.</p>

<p>Here is how it works:</p>

<p>Let&rsquo;s assume that Alice wants to send message M to Bob. If she sends only M to Bob, then Eve can easily modify M to M&rsquo;.</p>

<p>So, to prevent that from happening, Alice calculates MAC of M and sends both M and its MAC to Bob.</p>

<p>Bob can recalculate the MAC from the received M and crosscheck with the one he received from Alice. If they match, there was no tampering ç¯¡æ”¹ to M.</p>

<p>Here is how Bob can recompute MAC:</p>

<p>Both Alice and Bob negotiate on what kind of MAC calculation algorithm they are both going to use before Alice sends the message to Bob.</p>

<p>Recall that in computer security, algorithms are not secret (this is called open design). Therefore, Alice and Bob both know how to use the algorithm.</p>
</blockquote>

<h3 id="2-3-aes">2.3 AES</h3>

<ul>
<li>Advanced Encryption Standard - The Rijndael Block Cipher</li>
<li>ä¸ºæ‰¾åˆ°DESçš„æ›¿ä»£æ–¹æ¡ˆï¼ŒNIST (ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢) å‘èµ·äº†ç«èµ›ï¼Œè¦æ±‚

<ul>
<li>Symmetric-key ciphers supporting 128, 192, and 256 bit keys</li>
<li>Royalty-Free</li>
<li>Unclassified (i.e., public domain)</li>
<li>Available for worldwide export</li>
</ul></li>
<li>å…¶ä¸­ç¬¬ä¸€åæ˜¯ Rijndael</li>
<li>Allows only 128, 192, and 256-bit key sizes (unlike other candidates)</li>
<li>Variable input block length: 128, 192, or 256 bits. All nine combinations of key-block length possible.</li>
<li>Vast speed improvement over DES in both hw and sw
implementations

<ul>
<li>8,416 bytes/sec on a 20MHz 8051</li>
<li>8.8 Mbytes/sec on a 200MHz Pentium Pro
<br /></li>
</ul></li>
</ul>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123182414.jpg" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191122090557.jpg" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183214.png" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183224.png" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183230.png" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183235.png" alt="" /></p>

<p>å…³äº implement ä¸Šç›¸å¯¹DESçš„æå‡ï¼š</p>

<ul>
<li><p>Well-suited for software implementations on 8-bit
processors (important for â€œSmart Cardsâ€)</p>

<ul>
<li>Atomic operations focus on bytes and nibbles, not 32- or 64-bit integers</li>
<li>Layers such as ByteSub can be efficiently implemented using small tables in ROM (e.g., &lt; 256 bytes).</li>
<li>No special instructions are required to speed up operation, e.g.,barrel-shifting registers on some embedded device microprocessors</li>
</ul></li>

<li><p>For 32-bit implementations:</p>

<ul>
<li>An entire round can be implemented via a fast table lookup routine on machines with 32-bit or higher word length</li>
<li>Considerable parallelism exists in the algorithm</li>
<li>Each layer of Rijndael operates in a parallel manner on the bytes of the round state, all four component transforms act on individual parts of the block</li>
<li>Although the Key expansion is complicated and cannot benefit much from parallelism, it only needs to be performed once when the two parties switch keys</li>
</ul></li>

<li><p>Hardware Implementations</p>

<ul>
<li>Rijndael performs very well in software, but there are cases when better performance is required (e.g., server and VPN applications).</li>
<li>Multiple S-Box engines, round-key XORs, and byte shifts can all be implemented efficiently in hardware when absolute speed is required</li>
<li>Small amount of hardware can vastly speed up 8-bit implementations</li>
</ul></li>

<li><p>Inverse Cipher</p>

<ul>
<li>Except for the non-linear ByteSub step, each part of Rijndael has a straightforward inverse and the operations simply need to be undone in the reverse order.</li>
<li>However, Rijndael was specially written so that the same code that encrypts a block can also decrypt the same block simply by changing certain tables and polynomials for each layer. The rest of the operation remains identical.</li>
</ul></li>
</ul>

<h2 id="3-hash">3. hash</h2>

<h3 id="3-1-cryptographic-hash-functions">3.1 Cryptographic Hash Functions</h3>

<ul>
<li>ç¼©å†™ï¼šCHF</li>
<li>ä¼˜ç§€çš„å¯†ç å­¦hashå‡½æ•°æ€§è´¨ ( âœ…è¡¨ç¤ºæœ¬èº«hash functionå°±å…·æœ‰çš„åŠŸèƒ½ )

<ol>
<li>Takes on input of any size âœ…</li>
<li>Produces fixed-length output âœ…</li>
<li>Easy to compute (efficient) âœ…</li>
<li>Given any <code>h</code>, computationally infeasible to find any <code>x</code> such that <code>H(x) = h</code> â¡ï¸ One-Way-ness</li>
<li>For a given <code>x</code>, computationally infeasible to find <code>y</code>: <code>H(y) = H(x)</code> and <code>yâ‰ x</code> â¡ï¸ Weak Collision-Resistance</li>
<li>Computationally infeasible to find any <code>(x, y)</code> such that <code>H(x) = H(y)</code> and <code>x â‰  y</code> â¡ï¸ Strong Collision-Resistance</li>
</ol></li>
</ul>

<h3 id="3-2-merkle-damgard-construction">3.2 Merkle-Damgard construction</h3>

<ul>
<li>compression function f(): fixed-size</li>
</ul>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183309.jpg" alt="" /></p>

<h3 id="3-3-birthday-paradox">3.3 Birthday Paradox</h3>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191122090801.jpg" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183328.jpg" alt="" /></p>

<p><strong>How long should a hash be?</strong></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183350.jpg" alt="" /></p>

<p>ä¸ªäººè®¤ä¸ºè¿™é‡Œçš„1/2æ˜¯æ ¹æ®ä¸Šé¢çš„å›¾ä¼°è®¡å‡ºæ¥çš„ï¼Œè¯¦æƒ…è§<a href="https://iacr.org/archive/eurocrypt2004/30270396/bk.pdf">è®ºæ–‡ Hash Function Balance
and its Impact on Birthday Attacks</a></p>

<h3 id="3-4-chf-from-a-block-cipher">3.4 CHF from a Block Cipher</h3>

<ol>
<li>Split input into a sequence of keys: <code>M1,â€¦Mp</code></li>
<li>Encrypt a constant plaintext (e.g., block of
zeros) with this sequence of keys: <code>Hi = E ( Mi, Hi-1 ), H0= 0</code></li>
<li>Final ciphertext <code>Hp</code> is the hash output</li>
</ol>

<p><strong>Davies-Meyer CHF</strong> åŠ å¯†æ–¹ç¨‹ä¸ºå¼‚æˆ–âŠ•</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183427.jpg" alt="" /></p>

<h3 id="3-5-hash-func-examples">3.5 Hash Func Examples</h3>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183449.jpg" alt="" /></p>

<p><strong>Latest standard: SHA-3</strong></p>

<ul>
<li><p>ä»ç„¶æ˜¯ NIST (ç¾å›½å›½å®¶æ ‡å‡†ä¸æŠ€æœ¯ç ”ç©¶é™¢) å‘èµ·çš„ä¸€åœºç«èµ›ï¼Œ07å¹´å¼€å§‹å¾æ±‚åè®®ï¼Œ08å¹´æœ‰51ä»½æäº¤ï¼Œ09å¹´14ä»½è¿›å…¥åŠå†³èµ›ï¼Œæœ€å10å¹´5ä»½å†³èµ›ï¼Œæœ€ç»ˆçš„èƒœå‡ºè€…æ˜¯ Keccak</p></li>

<li><p>Designed by Bertoni, Daemen, Peeters, Van Assche.</p></li>

<li><p>Based on â€œ<strong>sponge construction</strong>â€ <a href="https://zh.wikipedia.org/wiki/%E6%B5%B7%E7%B6%BF%E5%87%BD%E6%95%B8">æµ·ç»µå‡½æ•°</a>, a completely
different structure from prior CHF-s.</p></li>
</ul>

<h3 id="3-6-message-authentication">3.6 Message Authentication</h3>

<p>å“ˆå¸Œå‡½æ•°é™¤äº†èƒ½ä¿è¯æ¶ˆæ¯çš„å®Œæ•´æ€§ï¼Œè¿˜èƒ½åº”ç”¨äº Message Authenticationï¼š</p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183512.jpg" alt="" /></p>

<p>ä¸‹é¢é‚£ç§æ–¹æ³•æ¯”ä¸Šé¢çš„æ›´ç®€å•ï¼Œä¸éœ€è¦åŠ å¯†è§£å¯†ï¼Œåªéœ€è¦æ¯”è¾ƒå“ˆå¸Œå€¼å°±è¡Œã€‚æˆ‘åŸæ¥æ³¨æ˜äº†å®ƒæ˜¯Challenge-response authentication ä½†å…¶å®ä¸å¤ªä¸€æ ·ï¼Œåè€…æ›´åŠ å¤æ‚ï¼Œè¯¦è§<a href="https://medium.com/@nipunadilhara/challenge-response-authentication-protocol-850925f50813">é“¾æ¥</a>ã€‚</p>

<h3 id="3-7-hmac">3.7 HMAC</h3>

<ul>
<li>Just computing and appending H(m) to m is enough for integrity but not for authenticity è¿™å¥è¯æ„æ€æ˜¯æˆ‘ä»¬å°†å“ˆå¸Œåå¾—åˆ°çš„ message digest é™„åœ¨åŸæ¥çš„ message åé¢åªèƒ½ç”¨ä½œéªŒè¯æ–‡æœ¬çš„å®Œæ•´æ€§ï¼Œä½†æˆ‘ä»¬æ— æ³•ç”¨æ¥éªŒè¯èº«ä»½ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªâ€œKeyed Hashâ€</li>
</ul>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183546.jpg" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183604.jpg" alt="" /></p>

<p><strong>ç®—æ³•æµç¨‹</strong></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183620.jpg" alt="" /></p>

<h2 id="4-asymmetric-encryption-å››-äº”">4. asymmetric encryption [å››ã€äº”]</h2>

<h3 id="4-1-number-theory">4.1 Number Theory</h3>

<p><strong>4.1.1 åˆ¤æ–­æœ‰é™ä»£æ•°ç»“æ„ï¼ˆFinite Algebraic Structuresï¼‰</strong></p>

<ol>
<li><strong>Group (G,@)</strong>: closure / associativity / identity / inverse</li>
<li><strong>Abelian é˜¿è´å°”ç¾¤/äº¤æ¢ç¾¤</strong>: commutativity</li>
<li><strong>Cyclic</strong>: group generator <code>G=&lt;g&gt;</code></li>
<li><strong>Order of a group</strong>: the size of set G <code>|G|</code> or <code>#{G}</code> or <code>ord(G)</code></li>
<li>Group (G,@) is finite if ord(G) is finite</li>
<li><strong>Rings (R, +, *)</strong>ï¼š  (R, +) is an Abelian group (identity=0) &amp; closure / associativity / identity=1 / distribution</li>
<li><strong>Monoid</strong>: associative / identity</li>
<li><strong>Fields (F, +, *)</strong>: Commutative Ring + Inverse(*)</li>
<li><strong>Subgroup (G,@)</strong>: H is a subset of G &amp; (H, @) is a group</li>
</ol>

<p>Some cases hard to understand:</p>

<ol>
<li>Integers mod(p) (where p is Prime) under Multiplication -&gt; Nonzero integers mod p -&gt; è¿™ä¸ªé›†åˆåŒ…å«æ‰€æœ‰æ¨¡pç­‰äº1,2,&hellip;,(p-1)çš„æ•°</li>
<li>non-zero integers mod N = {1 â€¦, x, â€¦ n-1} such that GCD(x, N)=1 -&gt; è¿™ä¸ªé›†åˆåŒ…å«æ‰€æœ‰æ¨¡nç­‰äº1,2,&hellip;,(n-1)çš„æ•°ï¼Œå’Œå‰ä¸€ä¸ªçš„åŒºåˆ«åœ¨äºè¿™é‡Œ N ä¸ä¸€å®šæ˜¯è´¨æ•°ï¼Œä»»ä½•æ•°éƒ½å¯ä»¥</li>
</ol>

<p><strong>4.1.2 extended euclidian algorithm</strong></p>

<p><img src="https://i.loli.net/2019/10/29/CVGBUunti3WI9rQ.jpg" alt="" />
<img src="https://i.loli.net/2019/10/29/yiuMNqWR3kcsGpm.jpg" alt="" /></p>

<p><strong>4.1.3 chinese remainder theorem(CRT)</strong></p>

<p><img src="https://i.loli.net/2019/10/29/x9sGP576EgHfIkY.jpg" alt="" />
<img src="https://i.loli.net/2019/10/29/6T5AFeMiRXrPQDc.jpg" alt="" /></p>

<h3 id="4-2-asymmetric-cryptography">4.2 Asymmetric Cryptography</h3>

<ul>
<li>ä¹Ÿå« Public Key Cryptography</li>
<li>ä¼˜ç‚¹ï¼šno key distribution problem</li>
<li>ç¼ºç‚¹ï¼šslow (å¯¹ç§° - bitwise operation / éå¯¹ç§° - multiplication, exponentiation and modular arithmetic)</li>
<li>Encryption done with public key, decryption done with private key</li>
<li>Digital signatures

<ul>
<li>Signing done with private key, verification done with public key</li>
<li>Signature is encryption of message hash and provided along with the message ã€Q:æ‰€ä»¥è¯´ä¼ é€’çš„ä¿¡æ¯ä¸ºï¼šåŸä¿¡æ¯+åŸä¿¡æ¯å“ˆå¸Œåç»è¿‡åŠ å¯†çš„ç­¾åï¼ŸA:å‘é€æŠ¥æ–‡æ—¶ï¼Œå‘é€æ–¹ç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ä»æŠ¥æ–‡æ–‡æœ¬ä¸­ç”ŸæˆæŠ¥æ–‡æ‘˜è¦,ç„¶åç”¨å¯¹æ–¹çš„å…¬é’¥å¯¹è¿™ä¸ªæ‘˜è¦è¿›è¡ŒåŠ å¯†ï¼Œè¿™ä¸ª<strong>åŠ å¯†åçš„æ‘˜è¦</strong>å°†<strong>ä½œä¸ºæŠ¥æ–‡çš„æ•°å­—ç­¾å</strong>å’Œ<strong>æŠ¥æ–‡</strong>ä¸€èµ·å‘é€ç»™æ¥æ”¶æ–¹ï¼Œæ¥æ”¶æ–¹é¦–å…ˆç”¨ä¸å‘é€æ–¹ä¸€æ ·çš„å“ˆå¸Œå‡½æ•°ä»æ¥æ”¶åˆ°çš„åŸå§‹æŠ¥æ–‡ä¸­è®¡ç®—å‡ºæŠ¥æ–‡æ‘˜è¦ï¼Œæ¥ç€å†ç”¨æ¥æ”¶æ–¹çš„ç§é’¥æ¥å¯¹æŠ¥æ–‡é™„åŠ çš„æ•°å­—ç­¾åè¿›è¡Œè§£å¯†ï¼Œå¦‚æœè¿™ä¸¤ä¸ªæ‘˜è¦ç›¸åŒã€é‚£ä¹ˆæ¥æ”¶æ–¹å°±èƒ½ç¡®è®¤è¯¥æ•°å­—ç­¾åæ˜¯å‘é€æ–¹çš„ã€‚(from ç™¾åº¦ç™¾ç§‘)ã€‘</li>
<li>Provides authentication (è®¤è¯ï¼Œæ˜¯ä¸æ˜¯å¯¹æ–¹å‘çš„ï¼Ÿ), integrity (æ¶ˆæ¯æœ‰æ²¡æœ‰è¢«ä¸­é—´äººæ¶æ„ç¯¡æ”¹ï¼Ÿ), and non-repudiation (ä¸å¯æŠµèµ–çš„)</li>
</ul></li>
</ul>

<h4 id="4-2-1-diffie-hellman-key-exchange">4.2.1 Diffieâ€“Hellman key exchange</h4>

<p>wiki: <strong>è¿ªè²-èµ«å°”æ›¼å¯†é’¥äº¤æ¢</strong>æ˜¯ä¸€ä¸ªåŒ¿åï¼ˆæ— è®¤è¯ï¼‰çš„å¯†é’¥äº¤æ¢åè®®ã€‚å®ƒå¯ä»¥è®©åŒæ–¹åœ¨å®Œå…¨æ²¡æœ‰å¯¹æ–¹ä»»ä½•é¢„å…ˆä¿¡æ¯çš„æ¡ä»¶ä¸‹ <em>é€šè¿‡ä¸å®‰å…¨ä¿¡é“åˆ›å»ºèµ·ä¸€ä¸ªå¯†é’¥</em> ï¼Œè¿™ä¸ªå¯†é’¥å¯ä»¥åœ¨åç»­çš„é€šè®¯ä¸­ä½œä¸ºå¯¹ç§°å¯†é’¥æ¥åŠ å¯†é€šè®¯å†…å®¹ã€‚å®ƒæ˜¯å¾ˆå¤šè®¤è¯åè®®çš„åŸºç¡€ï¼Œå¹¶ä¸”è¢«ç”¨æ¥æä¾›ä¼ è¾“å±‚å®‰å…¨åè®®çš„çŸ­æš‚æ¨¡å¼ä¸­çš„å‰å‘å®‰å…¨æ€§ã€‚ï¼ˆåä¸€ç¯‡ç¦»æ•£æ•°å­¦çš„postæœ€åéƒ¨åˆ†ä¹Ÿå…³äºè¿™ä¸ªè¿‡ç¨‹çš„æµç¨‹å›¾ï¼‰</p>

<p><img src="https://i.loli.net/2019/10/30/QwkRIBEsDWKJu6P.jpg" alt="" />
<img src="https://i.loli.net/2019/10/30/96JgBMaAXbUpRqj.jpg" alt="" /></p>

<p>å½“ç„¶ï¼Œæ‰€æœ‰ç®—æ³•å¯è¡Œçš„å‰ææ˜¯å®ƒä»¬çš„é—®é¢˜æ˜¯ HARD çš„ï¼Œä¸å±äº P classï¼›æœ‰ç‚¹ä¸ç†è§£DHå’ŒDDHçš„åŒºåˆ«ï¼Œ<a href="https://crypto.stackovernet.com/cn/q/1183">è¿™ä¸ªå›ç­”</a>æä¾›äº†å¸®åŠ©ï¼š
<img src="https://i.loli.net/2019/10/30/vPCQiO8gcaJBAl9.jpg" alt="" /></p>

<p>æ­¤å¤–ï¼ŒDiffieâ€“Hellmanåªæœ‰å½“æ”»å‡»è€…å¤„äºç›‘å¬çŠ¶æ€ï¼ˆpassiveï¼‰æ—¶æ‰æœ‰æ•ˆï¼Œå¦‚æœä½ æ­£åœ¨å’Œä¸€ä¸ªä¼ªè£…æˆåˆ«äººçš„æ”»å‡»è€…ï¼ˆactiveï¼‰é€šä¿¡ï¼Œè¿™ç§äº¤æ¢åè®®æ˜¯æ— æ•ˆçš„ã€‚</p>

<p>é‚£æœ‰æ²¡æœ‰å¯èƒ½åˆ©ç”¨å¯¹ç§°åŠ å¯†æ¥äº¤æ¢å¯†é’¥å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ Merkleâ€™s Puzzles (1974) <a href="https://www.youtube.com/watch?v=e3VxAM2oqYI">ğŸ”—</a>
<img src="https://i.loli.net/2019/10/31/Y2aquK7TWHCVkR8.jpg" alt="" /></p>

<h4 id="4-2-2-rsa">4.2.2 RSA</h4>

<p><img src="https://i.loli.net/2019/10/30/eqtgCHT9BpW2sNo.jpg" alt="" /></p>

<p><strong>Why does it all work?</strong>
åœ¨è¿™ä¸ªåœ°æ–¹å¡äº†å¾ˆä¹…éƒ½æ²¡çœ‹æ‡‚æƒ³è¯´æ˜ä»€ä¹ˆï¼Œä¸¥é‡å½±å“å¤ä¹ æ•ˆç‡ã€‚åæ¥ç¿»å‡ ä¸ªæ¨èçš„textbookï¼Œå‘ç°æœ‰ä¸€æœ¬ï¼ˆNetwork Security: Private Communication in a Public Worldï¼‰åˆšå¥½èƒ½å¯¹ä¸Šã€‚è¯¾ä»¶æ‹Œä¹¦é£Ÿç”¨ï¼Œæ•ˆæœæ›´ä½³ï¼</p>

<p>è¿™é‡Œæ˜¯æƒ³è¯æ˜ <code>x^de = x mod n</code>, æ‰€ä»¥æ‰å¯ä»¥è¿˜åŸåŠ å¯†çš„å†…å®¹ã€‚<a href="https://baike.baidu.com/item/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E5%AE%9A%E7%90%86">æ‹‰æ ¼æœ—æ—¥å®šç†</a>æ˜¯è¯´ for any g in G, ord(g) divides ord(G)ï¼Œç½‘ä¸Šæ²¡æ€ä¹ˆæŸ¥åˆ°è¿™ä¸€å®šç†ï¼Œå¤§æ¦‚æ˜¯å…¶å®ƒå®šç†æ›´æœ‰åï¼Ÿ</p>

<p><img src="https://i.loli.net/2019/10/29/ZMiG1L6jcX3OdS7.jpg" alt="" /></p>

<p><strong>Why secure?</strong></p>

<ul>
<li>Conjecture: breaking RSA is polynomially equivalent to factoring n</li>

<li><p>Recall that n is very, very large</p></li>

<li><p>Why: n has unique factors p, q; Given p and q, computing (p-1) (q-1) is easy</p>

<ul>
<li><code>ed â‰¡ 1 mod Î¦(mn)</code></li>
<li>Use extended Euclidian</li>
</ul></li>
</ul>

<p><strong>å¤æ‚åº¦åˆ†æ</strong></p>

<ul>
<li><p>å¯ä»¥å‚è€ƒ<a href="https://crypto.stackexchange.com/questions/6164/how-do-i-derive-the-time-complexity-of-encryption-and-decryption-based-on-modula">é“¾æ¥</a>
<img src="https://i.loli.net/2019/10/30/S6IzMabfkVsoE9h.jpg" alt="" /></p></li>

<li><p>Square-and-Multiply ä¹Ÿå« å¿«é€Ÿå¹‚ æˆ– å¹³æ–¹æ±‚å¹‚ <a href="https://zh.wikipedia.org/wiki/%E5%B9%B3%E6%96%B9%E6%B1%82%E5%B9%82">ğŸ”—</a>
<img src="https://i.loli.net/2019/10/30/WIaNQkK8S9gDEUl.jpg" alt="" /></p></li>

<li><p>Speeding up RSA Decryption åˆ©ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œpã€qæ¯”nå°çš„å¤šï¼Œè®¡ç®—å¾—æ›´å¿«
<img src="https://i.loli.net/2019/10/30/IOFZztmUNx5fwsY.jpg" alt="" /></p></li>

<li><p>2 or more parties cannot share the same n
<img src="https://i.loli.net/2019/10/30/7thNQcqpnoB9POH.jpg" alt="" /></p></li>
</ul>

<p><strong>RSA Signature Scheme</strong></p>

<p><img src="https://i.loli.net/2019/10/29/R5GwWYpXmQVxtTr.jpg" alt="" /></p>

<ul>
<li><p>è¿™ç§æ–¹æ³•æ˜¯ä¸å®‰å…¨çš„</p>

<ul>
<li>In practice, we use a randomized version of RSA (implemented in PKCS#1)</li>
<li><strong>Hash the message</strong> and then <strong>sign the hash</strong></li>
</ul></li>

<li><p>The Good:</p>

<ul>
<li>Verification can be cheap (like RSA encryption)</li>
<li>Mechanically same as RSA decryption function</li>
<li>Security based on RSA encryption</li>
<li>Signing is harder but #verify-s &gt; 1 â€¦</li>
<li>Deterministic</li>
</ul></li>

<li><p>The Bad: <a href="https://crypto.stackexchange.com/questions/12768/why-hash-the-message-before-signing-it-with-rsa">ğŸ”—</a>  å¦‚æœä¸ä½¿ç”¨HASHå‡½æ•°çš„åæœ</p>

<ul>
<li>RSA is malleable: signatures can be â€œmassagedâ€ äº¤æ¢é¡ºåºæˆ–è€…ç›´æ¥æ‰”æ‰ä¸€ä¸²

<ul>
<li><code>m1^d * m2^d = (m1*m2)^d</code></li>
<li>ï¼ˆå­˜åœ¨æ€§ä¼ªé€ ï¼‰ä½¿ç”¨â€œå·²çŸ¥æ¶ˆæ¯æ”»å‡»â€  æ‹¼æ¥ä¹‹å‰çš„ç­¾å</li>
<li>ï¼ˆé€‰æ‹©æ€§ä¼ªé€ ï¼‰åˆ©ç”¨â€œé€‰æ‹©æ¶ˆæ¯æ”»å‡»â€  è¯·æ±‚å¤šä¸ªç­¾åæ‹¼æ¥</li>
</ul></li>
<li>Phony â€œrandomâ€ signatures ä»»ä½•äººéƒ½èƒ½æä¾›éšæœºé€‰æ‹© y, å¹¶è®¡ç®— m = y^e mod n æ¥ä¼ªé€ ç­¾åè€…å¯¹éšæœºæ¶ˆæ¯mçš„ç­¾å</li>
<li>compute <code>Y=RSA(e,X)=X^e mod n</code>

<ul>
<li>X is a signature of Y because <code>Y^d=X mod n</code></li>
<li>å”¯å¯†é’¥æ”»å‡»çš„å­˜åœ¨æ€§ä¼ªé€ </li>
</ul></li>
<li>è§£å†³æªæ–½å°±æ˜¯å¼•å…¥å“ˆå¸Œå‡½æ•°ï¼Œä½¿å¾—æ¶ˆæ¯åŒ…å«è¶³å¤Ÿå¤šçš„å¤šä½™åº¦
<br /></li>
</ul></li>

<li><p>The Ugly:</p>

<ul>
<li>Signing requires integrity!</li>
<li>How to sign multiple blocks when m &gt; n?</li>
<li>Deterministic â€“ needs additional randomization!</li>
</ul></li>
</ul>

<h4 id="4-2-3-el-gamal">4.2.3 El Gamal</h4>

<p><img src="https://i.loli.net/2019/10/29/E3nrNmskwqid7bf.jpg" alt="" /></p>

<ul>
<li>The good:

<ul>
<li>Signing is cheap(er)</li>
<li>Designed as a signature function</li>
<li>Non-deterministic (randomized)</li>
</ul></li>
<li>The bad:

<ul>
<li>Need GOOD source of random numbers</li>
<li>Randomizers cannot be revealed (trace)</li>
<li>Randomizers cannot be reused</li>
</ul></li>
</ul>

<h4 id="4-2-4-the-digital-signature-standard-dss">4.2.4 The Digital Signature Standard (DSS)</h4>

<ul>
<li>Why DSS

<ul>
<li>RSA issues: patents, malleability, etc.</li>
</ul></li>
<li>A variant of El Gamal, but better performance</li>
<li>Originally for |p|=512 bits, now up to 1024</li>
<li>Optimized for signature size (320- vs. 1024-bit)</li>
<li>Signing - 1 exp, 1 inv, verification - 2 exps, 1 inv</li>
<li>No attacks thus far
å·¦è¾¹æ˜¯EIï¼Œå³è¾¹æ˜¯DSS
<img src="https://i.loli.net/2019/10/31/P9MltcLGVXnmqHr.jpg" alt="" /></li>
</ul>

<h4 id="4-2-5-zero-knowledge-proof">4.2.5 Zero-knowledge proof</h4>

<ul>
<li>prove ownership of a secret without revealing any info about the secret
<img src="https://i.loli.net/2019/10/31/er8waUJPKGRSzBO.jpg" alt="" /></li>
</ul>

<h4 id="4-2-6-fiat-shamir-identification-scheme">4.2.6 Fiat-Shamir Identification Scheme</h4>

<p><img src="https://i.loli.net/2019/10/31/SKfVql46NP2gJWD.jpg" alt="" />
<img src="https://i.loli.net/2019/10/31/FAyJ3eo7YtT5fKq.jpg" alt="" />
Protocol is repeated t (usually 20, 30, or log n) times, and, if each one succeeds, V concludes that P is the claimed party.</p>

<p><strong>What if Prover knows the challenge ahead of time?</strong>
<img src="http://q5f66uxyd.bkt.clouddn.com/20191123183641.jpg" alt="" /></p>

<p><img src="http://q5f66uxyd.bkt.clouddn.com/20191123183659.jpg" alt="" /></p>

<p>âš ï¸è¿™ä¸¤ä¸ª x çš„è®¡ç®—æ˜¯ä¸ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ”»å‡»è€…æ— æ³•åŒæ—¶å¾—å‡ºä¸¤ç§å€¼ï¼ˆæ²¡çœ‹ä»”ç»†ç ”ç©¶äº†å¥½ä¹…ï¼Œè¿˜ä»¥ä¸ºè¿™ä¸ªç®—æ³•æœ‰æ¼æ´&hellip;)</p>

<p><strong>CLAIM: Protocol does not reveal ANY information about S</strong></p>

<ul>
<li>The Fiat-Shamir protocol is ZERO-KNOWLEDGE</li>
<li>
<img src="http://q5f66uxyd.bkt.clouddn.com/20191123183720.jpg" alt="" /></li>
</ul>

<p><strong>å®‰å…¨æ€§åˆ†æ</strong></p>

<ul>
<li>Clearly, if P knows S, then V is convinced of Pâ€™s identity</li>
<li>If P does not know S, it can either:

<ul>
<li>know R, but not RS mod n. Since P is choosing R, it cannot multiply it by the unknown value S</li>
<li>choose RS mod n, and thus can answer the second question: RS mod n. But, in this case, P cannot answer the first question R, since to do so, needs to divide by unknown S</li>
</ul></li>
<li>In any case, adversary cannot answer both questions, since otherwise he can compute S as the ratio between the two answers.</li>
<li>But, we assumed that computing S is hard, equivalent to factoring n.</li>
<li>Since P does not know in advance (when choosing R or RS mod n) which question that V will ask, he cannot foresee the required choice. He can succeed in guessing Vâ€™s question with probability <sup>1</sup>&frasl;<sub>2</sub> for each question.</li>
<li>The probability that V fails to catch P in all runs is thus: 2^(-t)

<ul>
<li>e.g., 1 in 1,000,000,000 for t=20</li>
</ul></li>
</ul>

<h2 id="reference">Reference</h2>

<ol>
<li>UCI CS134 è¯¾ä»¶ï¼ˆmainlyï¼‰</li>
<li><a href="https://blog.csdn.net/qq_43573718/article/details/90407185?utm_source=app#__3">ç°ä»£å¯†ç å­¦å¤ä¹ è¦ç‚¹æ€»ç»“ï¼ˆè°·åˆ©æ³½ï¼‰</a></li>
</ol>
        </div>

        


        


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='https://hanmei.netlify.com/tags/%E5%AF%86%E7%A0%81%E5%AD%A6'>å¯†ç å­¦</a></li>
                
                <li><a href='https://hanmei.netlify.com/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8'>ç½‘ç»œå®‰å…¨</a></li>
                
            </ul>
            
        </div>
    </article>
    
    

    
    
</div>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://hanmei.netlify.com/search/'
      method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://hanmei.netlify.com/">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>

    

    <section class="widget">
        <div id="calendar" class="auto-jsCalendar"></div>
    </section>

    <section class="widget">
        <h3 class="widget-title">åˆ†ç±»</h3>
<ul class="widget-list">
    
    <li><a href="https://hanmei.netlify.com/categories/">Categories (1)</a></li>
    
    <li><a href="https://hanmei.netlify.com/categories/CS%E8%AF%BE%E7%A8%8B%E5%AD%A6%E4%B9%A0/">CSè¯¾ç¨‹å­¦ä¹  (19)</a></li>
    
    <li><a href="https://hanmei.netlify.com/categories/blog%E6%90%AD%E5%BB%BA/">blogæ­å»º (2)</a></li>
    
    <li><a href="https://hanmei.netlify.com/categories/%E5%AD%A6%E6%9C%AF/">å­¦æœ¯ (2)</a></li>
    
    <li><a href="https://hanmei.netlify.com/categories/%E6%8A%80%E6%9C%AF/">æŠ€æœ¯ (7)</a></li>
    
    <li><a href="https://hanmei.netlify.com/categories/%E6%97%A5%E5%B8%B8%E8%AE%B0%E5%BD%95/">æ—¥å¸¸è®°å½• (29)</a></li>
    
    <li><a href="https://hanmei.netlify.com/categories/%E7%94%9F%E6%B4%BB/">ç”Ÿæ´» (1)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title">æ ‡ç­¾</h3>
<div class="tagcloud">
    
    <a href="https://hanmei.netlify.com/tags/">Tags</a>
    
    <a href="https://hanmei.netlify.com/tags/WebGL/">WebGL</a>
    
    <a href="https://hanmei.netlify.com/tags/blog/">blog</a>
    
    <a href="https://hanmei.netlify.com/tags/bug%E8%AE%B0%E5%BD%95/">bugè®°å½•</a>
    
    <a href="https://hanmei.netlify.com/tags/git/">git</a>
    
    <a href="https://hanmei.netlify.com/tags/linux/">linux</a>
    
    <a href="https://hanmei.netlify.com/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/">å›¾å½¢å­¦</a>
    
    <a href="https://hanmei.netlify.com/tags/%E5%AF%86%E7%A0%81%E5%AD%A6/">å¯†ç å­¦</a>
    
    <a href="https://hanmei.netlify.com/tags/%E6%8C%81%E7%BB%AD%E8%A1%A5%E5%85%85.../">æŒç»­è¡¥å……...</a>
    
    <a href="https://hanmei.netlify.com/tags/%E6%B5%8B%E8%AF%84/">æµ‹è¯„</a>
    
    <a href="https://hanmei.netlify.com/tags/%E7%A6%BB%E6%95%A3%E6%95%B0%E5%AD%A6/">ç¦»æ•£æ•°å­¦</a>
    
    <a href="https://hanmei.netlify.com/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/">ç½‘ç»œå®‰å…¨</a>
    
    <a href="https://hanmei.netlify.com/tags/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">è®ºæ–‡é˜…è¯»</a>
    
    <a href="https://hanmei.netlify.com/tags/%E8%BF%90%E5%8A%A8%E4%BC%AA%E5%BD%B1%E6%B6%88%E9%99%A4/">è¿åŠ¨ä¼ªå½±æ¶ˆé™¤</a>
    
    <a href="https://hanmei.netlify.com/tags/%E9%80%9F%E6%9F%A5/">é€ŸæŸ¥</a>
    
    <a href="https://hanmei.netlify.com/tags/%E9%85%B8%E5%A5%B6/">é…¸å¥¶</a>
    
    <a href="https://hanmei.netlify.com/tags/%E9%9B%B6%E9%A3%9F/">é›¶é£Ÿ</a>
    
</div>
    </section>

    

    <section class="widget">
        <h3 class="widget-title">å…¶å®ƒ</h3>
        <ul class="widget-list">
            <li><a href="https://hanmei.netlify.com/index.xml">æ–‡ç«  RSS</a></li>
        </ul>
    </section>
</div>
<script type="text/javascript" src='/js/jsCalendar.js?v=0.0.0'></script>
            </div>
        </div>
    </div>
    <footer id="footer">
    <div class="container">
        &copy; 2020 <a href="https://hanmei.netlify.com/">Hanmei@æ¢….</a>
        Powered by <a rel="nofollow noreferer noopener" href="https://gohugo.io" target="_blank">Hugo</a>.
        Theme based on <a href="https://github.com/flysnow-org/maupassant-hugo" target="_blank">maupassant</a>.
        
    </div>
</footer>



<script type="text/javascript">
    window.MathJax = {
        tex2jax: {
            inlineMath: [['$', '$']],
            processEscapes: true
        }
    };
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>


<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>



<script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




</body>

</html>